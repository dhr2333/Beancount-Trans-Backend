sequenceDiagram
    participant 用户
    participant 前端
    participant 后端
    participant 规则引擎
    participant AI服务
    participant 缓存
    
    用户->>前端: 上传账单文件
    前端->>后端: 发送文件内容
    后端->>规则引擎: 解析记录
    
    alt 匹配到单个关键字
        规则引擎-->>后端: 返回结果
    else 匹配到多个关键字
        后端->>AI服务: 请求消歧处理
        AI服务-->>后端: 返回推荐结果
    end
    
    后端->>缓存: 存储原始数据+结果(1小时)
    后端-->>前端: 返回解析结果
    
    alt 用户接受结果
        用户->>前端: 确认保存
    else 用户选择其他关键字
        用户->>前端: 提交反馈
        前端->>后端: 发送新关键字
        后端->>缓存: 获取原始数据
        后端->>规则引擎: 重新解析
        规则引擎-->>后端: 返回新结果
        后端-->>前端: 更新显示
    end